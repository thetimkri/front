# Документация проекта "Новости Добрых Деяний"

## Цель проекта

Проект **"Новости Добрых Деяний"** – это информационная площадка и ежегодный журнал Добрых Новостей со всей России. Проект создан с целью распространения идеи доброго, милосердного и созидательного общества через публикацию и популяризацию позитивных историй, демонстрирующих доброту, заботу и взаимопомощь.

## Технический стек

Проект разработан с использованием современных технологий:

### Frontend
- **React** (v18.3.1) - основная библиотека UI
- **TypeScript** - типизированный JavaScript для большей стабильности кода
- **Vite** - быстрый инструмент для сборки приложения
- **React Router DOM** - маршрутизация на клиентской стороне
- **TanStack/React Query** - управление состоянием и кешированием данных
- **Styled Components** - стилизация компонентов с помощью CSS-in-JS
- **CKEditor 5** - WYSIWYG редактор для создания контента
- **Swiper** - компонент для создания слайдеров
- **React Hook Form** - управление формами и валидация

### Инструменты разработки
- **ESLint** - статический анализ кода
- **Prettier** - форматирование кода
- **Husky** - хуки Git для автоматического запуска линтеров перед коммитом
- **lint-staged** - запуск линтеров только для измененных файлов
- **Docker** - контейнеризация приложения

## Структура проекта

Проект организован в соответствии с принципами Feature-Sliced Design (FSD) архитектуры:

```
├── node_modules/            # Зависимости проекта
├── src/                     # Исходный код
│   ├── app/                 # Конфигурация приложения
│   ├── assets/              # Статические ресурсы (изображения, шрифты)
│   ├── entities/            # Хуки для запросов
│   ├── features/            # Функциональные модули
│   ├── pages/               # Страницы приложения
│   ├── shared/              # Общие утилиты, константы, хуки
│   │   ├── api/             # Настройка API
│   │   ├── constants/       # Константы приложения
│   │   ├── layout/          # Компоненты макета
│   │   ├── UiKit/           # Базовые UI компоненты
│   │   └── utils/           # Утилитарные функции
│   ├── widgets/             # Композиционные компоненты более высокого уровня
│   ├── main.tsx             # Точка входа приложения
│   └── vite-env.d.ts        # Типы для Vite
├── .env                     # Переменные окружения
├── .env.example             # Пример переменных окружения
├── .gitignore               # Игнорируемые Git файлы
├── .prettierrc              # Конфигурация Prettier
├── docker-compose.yml       # Конфигурация Docker Compose
├── docker-compose-local.yml # Локальная конфигурация Docker Compose
├── Dockerfile               # Инструкции для сборки Docker образа
├── Dockerfile-local         # Инструкции для локальной Docker сборки
├── eslint.config.js         # Конфигурация ESLint
├── index.html               # Входная HTML точка
├── package.json             # Зависимости и скрипты проекта
├── package-lock.json        # Локи зависимостей
├── README.md                # Документация проекта
├── tsconfig.app.json        # Конфигурация TypeScript для приложения
├── tsconfig.app.tsbuildinfo # Кэш компиляции TypeScript
├── tsconfig.json            # Основная конфигурация TypeScript
├── tsconfig.node.json       # Конфигурация TypeScript для Node.js
├── tsconfig.node.tsbuildinfo # Кэш компиляции TypeScript для Node.js
└── vite.config.ts           # Конфигурация Vite
```

Архитектура проекта следует подходу Feature-Sliced Design (FSD), который разделяет код на слои по степени бизнес-значимости и уровню переиспользования:

1. **app** - конфигурация и инициализация приложения
2. **entities** - хуки для запросов
3. **features** - пользовательские функции
4. **widgets** - композиционные блоки интерфейса
5. **shared** - переиспользуемые утилиты и инструменты
6. **pages** - страницы приложения, объединяющие компоненты из других слоев

## Запуск проекта

### Локальная разработка

1. Клонировать репозиторий:
```bash
git clone [url-репозитория]
cd frontend
```

2. Установить зависимости:
```bash
npm install
```

3. Запустить сервер разработки:
```bash
npm run dev
```
Приложение будет доступно по адресу: http://localhost:5173/

### Сборка для продакшена

```bash
npm run build
```
Собранное приложение будет находиться в директории `dist/`.

### Запуск собранного приложения

```bash
npm run preview
```

## Запуск в Docker

### Предварительные требования
- Docker
- Docker Compose

### Запуск контейнера фронтенда

```bash
docker-compose -f docker-compose-local.yml up --build
```

## Структура Docker файлов

Проект содержит несколько Docker файлов для различных окружений:

- `Dockerfile` - основной файл для продакшен-сборки
- `Dockerfile-local` - файл для локальной разработки
- `docker-compose.yml` - основная конфигурация Docker Compose
- `docker-compose-local.yml` - конфигурация для локальной разработки

## Интеграция с бэкендом

Проект взаимодействует с бэкенд-API для получения и отправки данных. Конфигурация API находится в директории `src/shared/api/`. Для локальной разработки с бэкендом необходимо следовать инструкциям из раздела "Гайд по поднятию бэкенда и фронтенда в Docker".

## Разработка и тестирование

### Правила форматирования кода

Проект использует ESLint и Prettier для обеспечения единого стиля кода. Для проверки кода можно использовать команду:

```bash
npm run lint
```

### Pre-commit хуки

В проекте настроены pre-commit хуки с помощью Husky и lint-staged, которые автоматически запускают проверку и форматирование измененных файлов перед коммитом.

## Гайд по поднятию бэкенда и фронтенда в Docker

### Условия
- Умение пользоваться GitLab
- Docker установлен и настроен
- Docker Compose установлен
- Все нужные доступы к репозиторию есть

### Примечания
- Для фронтенда не обязательно запускать контейнер через Docker. Можно использовать команды Vite, такие как npm run dev, для локальной разработки.
- Для локальной разработки с использованием Vite, перед запуском убедитесь, что у вас установлены все зависимости с помощью npm install.
- Фронтенд будет доступен по адресу http://localhost:5173/, как при запуске через Vite, так и через Docker (если не изменены порты в конфигурации)

### 1. Переход в нужные ветки в GitLab
1. Открываем терминал и переходим в папку с проектом:
   ```sh
   cd path/to/project
   ```
2. Обновляем локальный репозиторий:
   ```sh
   git fetch --all
   ```
3. Переходим в нужные ветки для бэкенда и фронтенда:
   ```sh
   git checkout backend-branch-name
   git pull origin backend-branch-name
   ```
   ```sh
   git checkout frontend-branch-name
   git pull origin frontend-branch-name
   ```

### 2. Структура проекта
Для удобства лучше хранить бэкенд и фронтэнд в одной папке, например:
```
good-thinks/
  ├── backend/
  ├── frontend/
```

### 3. Запуск контейнеров
Запуск возможен двумя способами:

1. **Запуск из определенной папки проекта**
    - Переходим в нужную папку:
      ```sh
      cd backend  # Для бэкенда
      ```
      ```sh
      cd frontend  # Для фронтенда
      ```
    - Запускаем контейнеры:
      ```sh
      docker-compose up --build
      ```

2. **Запуск без перехода в папку проекта**
    - Открываем 1 командную строку и выполняем команду:
      ```sh
      docker-compose -f backend/docker-compose.yml up --build 
      ```
    - Открываем 2 командную строку и выполняем команду:
      ```sh
      docker-compose -f frontend/docker-compose-local.yml up --build
      ```

### 4. Проверка работы
1. Проверяем запущенные контейнеры:
   ```sh
   docker ps
   ```
2. Логи можно посмотреть командой:
   ```sh
   docker logs -f container_name
   ```
3. Проверяем доступность сервисов:
    - Бэкенд: `http://127.0.0.1:8000/api/v1/`
    - Фронтенд: `http://localhost:5173/`

### 5. Остановка и очистка
1. Если запуск был из определенной папки проекта:
      ``` sh
      docker-compose down
      ```
2. Если бэкенд и фронтенд запускались отдельными командами, их можно остановить так:
    - Бэкенд:
      ```sh
      docker-compose -f backend/docker-compose.yml down --remove-orphans
      ```
    - Фронтенд:
      ```sh
      docker-compose -f frontend/docker-compose-local.yml down --remove-orphans
      ```
3. Чтобы удалить ненужные образы и кеш:
   ```sh
   docker system prune -af
   ```

### 6. Полезные команды
- Перезапуск конкретного контейнера:
  ```sh
  docker restart container_name
  ```
- Открыть bash внутри контейнера:
  ```sh
  docker exec -it container_name bash
  ```
- Посмотреть переменные окружения:
  ```sh
  docker exec container_name env
  ```
